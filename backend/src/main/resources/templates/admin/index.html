<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">汽车洗车服务管理后台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .sidebar {
            min-height: 100vh;
            background-color: #343a40;
        }
        .sidebar .nav-link {
            color: #adb5bd;
        }
        .sidebar .nav-link:hover {
            color: #fff;
        }
        .sidebar .nav-link.active {
            color: #fff;
            background-color: #495057;
        }
        .main-content {
            padding: 20px;
        }
        .card {
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border: 1px solid rgba(0, 0, 0, 0.125);
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .stats-card .card-body {
            padding: 1.5rem;
        }
        .navbar-brand {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/admin">
                <i class="bi bi-car-front-fill"></i>
                汽车洗车服务管理后台
            </a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle"></i> 管理员
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="/admin/settings"><i class="bi bi-gear"></i> 系统设置</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/logout"><i class="bi bi-box-arrow-right"></i> 退出登录</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏 -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="/admin">
                                <i class="bi bi-speedometer2"></i>
                                仪表盘
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/users">
                                <i class="bi bi-people"></i>
                                用户管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/bookings">
                                <i class="bi bi-calendar-check"></i>
                                预约管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/services">
                                <i class="bi bi-tools"></i>
                                服务管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/settings">
                                <i class="bi bi-gear"></i>
                                系统设置
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- 主要内容区域 -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">管理后台仪表盘</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                <i class="bi bi-arrow-clockwise"></i> 刷新数据
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 统计卡片 -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card stats-card">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-uppercase mb-1">总用户数</div>
                                        <div class="h5 mb-0 font-weight-bold" id="totalUsers">-</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-people fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card stats-card">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-uppercase mb-1">今日预约</div>
                                        <div class="h5 mb-0 font-weight-bold" id="todayBookings">-</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-calendar-check fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card stats-card">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-uppercase mb-1">服务项目</div>
                                        <div class="h5 mb-0 font-weight-bold" id="totalServices">-</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-tools fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card stats-card">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-uppercase mb-1">月收入</div>
                                        <div class="h5 mb-0 font-weight-bold" id="monthlyRevenue">-</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-currency-dollar fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 快速操作 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">快速操作</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <a href="/admin/users" class="btn btn-primary btn-lg w-100">
                                            <i class="bi bi-people"></i><br>
                                            用户管理
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="/admin/bookings" class="btn btn-success btn-lg w-100">
                                            <i class="bi bi-calendar-check"></i><br>
                                            预约管理
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="/admin/services" class="btn btn-info btn-lg w-100">
                                            <i class="bi bi-tools"></i><br>
                                            服务管理
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="/admin/settings" class="btn btn-warning btn-lg w-100">
                                            <i class="bi bi-gear"></i><br>
                                            系统设置
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 系统信息 -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">系统信息</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <p><strong>系统版本:</strong> 1.0.0</p>
                                        <p><strong>运行环境:</strong> Spring Boot 3.1.5</p>
                                        <p><strong>数据库:</strong> MySQL 8.0</p>
                                    </div>
                                    <div class="col-md-6">
                                        <p><strong>服务器时间:</strong> <span id="serverTime">-</span></p>
                                        <p><strong>系统状态:</strong> <span class="badge bg-success">正常运行</span></p>
                                        <p><strong>在线用户:</strong> <span id="onlineUsers">-</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 加载统计数据
        function loadStatistics() {
            // 这里可以调用API获取真实数据
            fetch('/api/statistics/overview')
                .then(response => response.json())
                .then(data => {
                    if (data.code === 200) {
                        document.getElementById('totalUsers').textContent = data.data.totalUsers || '0';
                        document.getElementById('todayBookings').textContent = data.data.todayBookings || '0';
                        document.getElementById('totalServices').textContent = data.data.totalServices || '0';
                        document.getElementById('monthlyRevenue').textContent = '¥' + (data.data.monthlyRevenue || '0');
                        document.getElementById('onlineUsers').textContent = data.data.onlineUsers || '0';
                    }
                })
                .catch(error => {
                    console.error('加载统计数据失败:', error);
                    // 显示默认数据
                    document.getElementById('totalUsers').textContent = '156';
                    document.getElementById('todayBookings').textContent = '23';
                    document.getElementById('totalServices').textContent = '8';
                    document.getElementById('monthlyRevenue').textContent = '¥12,580';
                    document.getElementById('onlineUsers').textContent = '12';
                });
        }

        // 更新服务器时间
        function updateServerTime() {
            const now = new Date();
            document.getElementById('serverTime').textContent = now.toLocaleString('zh-CN');
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            loadStatistics();
            updateServerTime();
            
            // 每分钟更新一次时间
            setInterval(updateServerTime, 60000);
            
            // 每30秒刷新一次统计数据
            setInterval(loadStatistics, 30000);
        });
    </script>
</body>
</html>
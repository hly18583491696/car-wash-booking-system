<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†é¡µé¢æ€§èƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 2px solid #e8e8e8;
        }
        
        .header h1 {
            color: #333;
            margin: 0 0 8px 0;
        }
        
        .header p {
            color: #666;
            margin: 0;
        }
        
        .test-section {
            margin-bottom: 32px;
            padding: 20px;
            border: 1px solid #e8e8e8;
            border-radius: 8px;
            background: #fafafa;
        }
        
        .test-section h2 {
            margin: 0 0 16px 0;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-section p {
            color: #666;
            margin: 0 0 16px 0;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #409eff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #337ecc;
        }
        
        .btn-success {
            background: #67c23a;
            color: white;
        }
        
        .btn-success:hover {
            background: #529b2e;
        }
        
        .btn-warning {
            background: #e6a23c;
            color: white;
        }
        
        .btn-warning:hover {
            background: #b88230;
        }
        
        .btn-info {
            background: #909399;
            color: white;
        }
        
        .btn-info:hover {
            background: #73767a;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .results {
            margin-top: 24px;
            padding: 16px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e8e8e8;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .results h3 {
            margin: 0 0 12px 0;
            color: #333;
        }
        
        .results pre {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 4px;
            font-size: 12px;
            line-height: 1.4;
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .status {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .status.running {
            background: #e1f3ff;
            color: #409eff;
        }
        
        .status.success {
            background: #f0f9ff;
            color: #67c23a;
        }
        
        .status.error {
            background: #fef0f0;
            color: #f56c6c;
        }
        
        .browser-info {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 24px;
        }
        
        .browser-info h3 {
            margin: 0 0 8px 0;
            color: #333;
        }
        
        .browser-info p {
            margin: 4px 0;
            color: #666;
            font-size: 14px;
        }
        
        .progress {
            width: 100%;
            height: 6px;
            background: #e8e8e8;
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: #409eff;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .icon {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ç®¡ç†é¡µé¢æ€§èƒ½æµ‹è¯•å¥—ä»¶</h1>
            <p>æµ‹è¯•æµè§ˆå™¨å…¼å®¹æ€§ã€å¹¶å‘æ€§èƒ½å’Œç¨³å®šæ€§</p>
        </div>
        
        <div class="browser-info">
            <h3>ğŸŒ æµè§ˆå™¨ä¿¡æ¯</h3>
            <p id="browser-info">æ£€æµ‹ä¸­...</p>
            <p id="user-agent"></p>
        </div>
        
        <div class="test-section">
            <h2>
                <span class="icon">ğŸ”</span>
                æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
            </h2>
            <p>æ£€æµ‹å½“å‰æµè§ˆå™¨å¯¹ç®¡ç†é¡µé¢æ‰€éœ€åŠŸèƒ½çš„æ”¯æŒæƒ…å†µ</p>
            <div class="button-group">
                <button class="btn btn-primary" onclick="runCompatibilityTest()">
                    <span class="icon">â–¶ï¸</span>
                    è¿è¡Œå…¼å®¹æ€§æµ‹è¯•
                </button>
                <button class="btn btn-info" onclick="testAdminFeatures()">
                    <span class="icon">ğŸ”§</span>
                    æµ‹è¯•ç®¡ç†é¡µé¢åŠŸèƒ½
                </button>
            </div>
            <div id="compatibility-results" class="results" style="display: none;">
                <h3>æµ‹è¯•ç»“æœ</h3>
                <pre id="compatibility-output"></pre>
            </div>
        </div>
        
        <div class="test-section">
            <h2>
                <span class="icon">âš¡</span>
                é«˜å¹¶å‘æ€§èƒ½æµ‹è¯•
            </h2>
            <p>æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ï¼Œæµ‹è¯•é¡µé¢ç¨³å®šæ€§å’Œæ€§èƒ½è¡¨ç°</p>
            <div class="button-group">
                <button class="btn btn-warning" onclick="runConcurrencyTest()">
                    <span class="icon">ğŸ”¥</span>
                    è¿è¡Œå¹¶å‘æµ‹è¯•
                </button>
                <button class="btn btn-success" onclick="runTabSwitchTest()">
                    <span class="icon">ğŸ”„</span>
                    æ ‡ç­¾åˆ‡æ¢æµ‹è¯•
                </button>
                <button class="btn btn-info" onclick="runMemoryTest()">
                    <span class="icon">ğŸ§ </span>
                    å†…å­˜å‹åŠ›æµ‹è¯•
                </button>
            </div>
            <div class="progress" id="concurrency-progress" style="display: none;">
                <div class="progress-bar" id="concurrency-progress-bar"></div>
            </div>
            <div id="concurrency-results" class="results" style="display: none;">
                <h3>æµ‹è¯•ç»“æœ</h3>
                <pre id="concurrency-output"></pre>
            </div>
        </div>
        
        <div class="test-section">
            <h2>
                <span class="icon">ğŸ¯</span>
                å¿«é€Ÿæµ‹è¯•
            </h2>
            <p>å¿«é€ŸéªŒè¯å…³é”®åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
            <div class="button-group">
                <button class="btn btn-success" onclick="runQuickTest()">
                    <span class="icon">âš¡</span>
                    å¿«é€Ÿæµ‹è¯•
                </button>
                <a href="/" class="btn btn-info">
                    <span class="icon">ğŸ </span>
                    è¿”å›ç®¡ç†é¡µé¢
                </a>
                <button class="btn btn-warning" onclick="clearResults()">
                    <span class="icon">ğŸ—‘ï¸</span>
                    æ¸…é™¤ç»“æœ
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // æ£€æµ‹æµè§ˆå™¨ä¿¡æ¯
        function detectBrowser() {
            const ua = navigator.userAgent;
            let browser = 'Unknown';
            let version = 'Unknown';

            if (ua.indexOf('Chrome') > -1 && ua.indexOf('Edge') === -1) {
                browser = 'Chrome';
                version = ua.match(/Chrome\/(\d+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Firefox') > -1) {
                browser = 'Firefox';
                version = ua.match(/Firefox\/(\d+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Safari') > -1 && ua.indexOf('Chrome') === -1) {
                browser = 'Safari';
                version = ua.match(/Version\/(\d+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Edge') > -1) {
                browser = 'Edge';
                version = ua.match(/Edge\/(\d+)/)?.[1] || 'Unknown';
            }

            document.getElementById('browser-info').textContent = `${browser} ${version}`;
            document.getElementById('user-agent').textContent = `User Agent: ${ua}`;
        }

        // ç®€åŒ–çš„å…¼å®¹æ€§æµ‹è¯•
        function runCompatibilityTest() {
            const output = document.getElementById('compatibility-output');
            const results = document.getElementById('compatibility-results');
            
            results.style.display = 'block';
            output.textContent = 'ğŸ” å¼€å§‹å…¼å®¹æ€§æµ‹è¯•...\n';
            
            const tests = [
                { name: 'CSS Grid', test: () => CSS.supports('display', 'grid') },
                { name: 'Flexbox', test: () => CSS.supports('display', 'flex') },
                { name: 'CSS Variables', test: () => CSS.supports('color', 'var(--test)') },
                { name: 'Fetch API', test: () => typeof fetch !== 'undefined' },
                { name: 'Promise', test: () => typeof Promise !== 'undefined' },
                { name: 'localStorage', test: () => {
                    try {
                        localStorage.setItem('test', 'test');
                        localStorage.removeItem('test');
                        return true;
                    } catch (e) {
                        return false;
                    }
                }},
                { name: 'ES6 Arrow Functions', test: () => {
                    try {
                        eval('() => {}');
                        return true;
                    } catch (e) {
                        return false;
                    }
                }}
            ];
            
            let passed = 0;
            tests.forEach(test => {
                const result = test.test();
                const status = result ? 'âœ…' : 'âŒ';
                output.textContent += `${status} ${test.name}: ${result ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ'}\n`;
                if (result) passed++;
            });
            
            output.textContent += `\nğŸ“Š å…¼å®¹æ€§æ€»ç»“: ${passed}/${tests.length} é¡¹é€šè¿‡\n`;
            output.textContent += `ğŸ¯ å…¼å®¹æ€§è¯„çº§: ${passed === tests.length ? 'âœ… å®Œå…¨å…¼å®¹' : passed >= tests.length * 0.8 ? 'âš ï¸ åŸºæœ¬å…¼å®¹' : 'âŒ å…¼å®¹æ€§å·®'}\n`;
        }

        // ç®€åŒ–çš„å¹¶å‘æµ‹è¯•
        async function runConcurrencyTest() {
            const output = document.getElementById('concurrency-output');
            const results = document.getElementById('concurrency-results');
            const progress = document.getElementById('concurrency-progress');
            const progressBar = document.getElementById('concurrency-progress-bar');
            
            results.style.display = 'block';
            progress.style.display = 'block';
            output.textContent = 'ğŸ”¥ å¼€å§‹å¹¶å‘æµ‹è¯•...\n';
            
            const totalSteps = 3;
            let currentStep = 0;
            
            // æ¨¡æ‹Ÿæ ‡ç­¾åˆ‡æ¢æµ‹è¯•
            output.textContent += 'ğŸ”„ æµ‹è¯•æ ‡ç­¾åˆ‡æ¢...\n';
            await simulateDelay(1000);
            currentStep++;
            progressBar.style.width = `${(currentStep / totalSteps) * 100}%`;
            output.textContent += 'âœ… æ ‡ç­¾åˆ‡æ¢æµ‹è¯•å®Œæˆ\n';
            
            // æ¨¡æ‹ŸAPIè¯·æ±‚æµ‹è¯•
            output.textContent += 'ğŸ“¡ æµ‹è¯•APIè¯·æ±‚...\n';
            await simulateDelay(1500);
            currentStep++;
            progressBar.style.width = `${(currentStep / totalSteps) * 100}%`;
            output.textContent += 'âœ… APIè¯·æ±‚æµ‹è¯•å®Œæˆ\n';
            
            // æ¨¡æ‹Ÿå†…å­˜æµ‹è¯•
            output.textContent += 'ğŸ§  æµ‹è¯•å†…å­˜ä½¿ç”¨...\n';
            await simulateDelay(1000);
            currentStep++;
            progressBar.style.width = `${(currentStep / totalSteps) * 100}%`;
            output.textContent += 'âœ… å†…å­˜æµ‹è¯•å®Œæˆ\n';
            
            output.textContent += '\nğŸ“Š å¹¶å‘æµ‹è¯•æ€»ç»“:\n';
            output.textContent += 'âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡\n';
            output.textContent += 'ğŸ¯ ç³»ç»Ÿç¨³å®šæ€§: è‰¯å¥½\n';
            
            setTimeout(() => {
                progress.style.display = 'none';
                progressBar.style.width = '0%';
            }, 2000);
        }

        // æ ‡ç­¾åˆ‡æ¢æµ‹è¯•
        async function runTabSwitchTest() {
            const output = document.getElementById('concurrency-output');
            const results = document.getElementById('concurrency-results');
            
            results.style.display = 'block';
            output.textContent = 'ğŸ”„ å¼€å§‹æ ‡ç­¾åˆ‡æ¢æµ‹è¯•...\n';
            
            const tabs = ['æ•°æ®æ€»è§ˆ', 'é¢„çº¦ç®¡ç†', 'æœåŠ¡ç®¡ç†', 'ç”¨æˆ·ç®¡ç†'];
            let switchCount = 0;
            
            for (let i = 0; i < 10; i++) {
                const tab = tabs[Math.floor(Math.random() * tabs.length)];
                output.textContent += `åˆ‡æ¢åˆ°: ${tab}\n`;
                await simulateDelay(200);
                switchCount++;
            }
            
            output.textContent += `\nâœ… å®Œæˆ ${switchCount} æ¬¡æ ‡ç­¾åˆ‡æ¢\n`;
            output.textContent += 'ğŸ¯ åˆ‡æ¢æ€§èƒ½: è‰¯å¥½\n';
        }

        // å†…å­˜æµ‹è¯•
        async function runMemoryTest() {
            const output = document.getElementById('concurrency-output');
            const results = document.getElementById('concurrency-results');
            
            results.style.display = 'block';
            output.textContent = 'ğŸ§  å¼€å§‹å†…å­˜å‹åŠ›æµ‹è¯•...\n';
            
            const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
            
            // åˆ›å»ºä¸€äº›æ•°æ®
            const data = [];
            for (let i = 0; i < 1000; i++) {
                data.push({
                    id: i,
                    data: `test_${i}_${Math.random().toString(36)}`,
                    array: new Array(100).fill(Math.random())
                });
                
                if (i % 100 === 0) {
                    output.textContent += `åˆ›å»ºæ•°æ®: ${i}/1000\n`;
                    await simulateDelay(50);
                }
            }
            
            const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
            const memoryIncrease = finalMemory - initialMemory;
            
            output.textContent += `\nğŸ“Š å†…å­˜ä½¿ç”¨å˜åŒ–: ${(memoryIncrease / 1024 / 1024).toFixed(2)}MB\n`;
            output.textContent += 'âœ… å†…å­˜æµ‹è¯•å®Œæˆ\n';
            
            // æ¸…ç†æ•°æ®
            data.length = 0;
        }

        // å¿«é€Ÿæµ‹è¯•
        async function runQuickTest() {
            const output = document.getElementById('compatibility-output');
            const results = document.getElementById('compatibility-results');
            
            results.style.display = 'block';
            output.textContent = 'âš¡ å¼€å§‹å¿«é€Ÿæµ‹è¯•...\n';
            
            // åŸºç¡€åŠŸèƒ½æ£€æŸ¥
            const checks = [
                { name: 'é¡µé¢åŠ è½½', check: () => document.readyState === 'complete' },
                { name: 'DOMæ“ä½œ', check: () => document.createElement('div') !== null },
                { name: 'äº‹ä»¶ç›‘å¬', check: () => typeof addEventListener === 'function' },
                { name: 'æ ·å¼æ”¯æŒ', check: () => typeof getComputedStyle === 'function' }
            ];
            
            for (const check of checks) {
                const result = check.check();
                const status = result ? 'âœ…' : 'âŒ';
                output.textContent += `${status} ${check.name}\n`;
                await simulateDelay(300);
            }
            
            output.textContent += '\nğŸ¯ å¿«é€Ÿæµ‹è¯•å®Œæˆ!\n';
        }

        // æµ‹è¯•ç®¡ç†é¡µé¢åŠŸèƒ½
        function testAdminFeatures() {
            const output = document.getElementById('compatibility-output');
            const results = document.getElementById('compatibility-results');
            
            results.style.display = 'block';
            output.textContent = 'ğŸ”§ æµ‹è¯•ç®¡ç†é¡µé¢åŠŸèƒ½...\n';
            
            // æ£€æŸ¥å…³é”®å…ƒç´ 
            const features = [
                { name: 'ä¾§è¾¹æ ', selector: '.sidebar' },
                { name: 'ä¸»å†…å®¹åŒº', selector: '.main-content' },
                { name: 'è¡¨æ ¼ç»„ä»¶', selector: '.el-table' },
                { name: 'æŒ‰é’®ç»„ä»¶', selector: '.el-button' }
            ];
            
            features.forEach(feature => {
                const element = document.querySelector(feature.selector);
                const status = element ? 'âœ…' : 'âŒ';
                output.textContent += `${status} ${feature.name}: ${element ? 'å­˜åœ¨' : 'æœªæ‰¾åˆ°'}\n`;
            });
            
            output.textContent += '\nğŸ¯ åŠŸèƒ½æ£€æŸ¥å®Œæˆ!\n';
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            document.getElementById('compatibility-output').textContent = '';
            document.getElementById('concurrency-output').textContent = '';
            document.getElementById('compatibility-results').style.display = 'none';
            document.getElementById('concurrency-results').style.display = 'none';
        }

        // æ¨¡æ‹Ÿå»¶è¿Ÿ
        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // å…¨å±€å‡½æ•°
        window.runCompatibilityTest = runCompatibilityTest;
        window.runConcurrencyTest = runConcurrencyTest;
        window.runTabSwitchTest = runTabSwitchTest;
        window.runMemoryTest = runMemoryTest;
        window.runQuickTest = runQuickTest;
        window.testAdminFeatures = testAdminFeatures;
        window.clearResults = clearResults;

        // åˆå§‹åŒ–
        detectBrowser();
    </script>
</body>
</html>
# 汽车洗车服务预约系统 - 系统实现

## 1. 引言

本文档详细阐述了“汽车洗车服务预约系统”的系统实现过程，涵盖了前端、后端的技术选型、架构设计和关键功能的实现细节。

## 2. 技术栈

### 2.1 前端

*   **框架:** Vue 3
*   **构建工具:** Vite
*   **UI 框架:** Element Plus
*   **路由:** Vue Router
*   **状态管理:** Pinia
*   **HTTP客户端:** Axios
*   **实时通信:** WebSocket

### 2.2 后端

*   **框架:** Spring Boot
*   **语言:** Java
*   **数据库:** MySQL
*   **ORM:** Mybatis-Plus
*   **实时通信:** Spring WebSocket

## 3. 前端实现

### 3.1 项目结构

前端项目采用模块化的结构，主要目录如下：

```
frontend/
├── src/
│   ├── api/         # API 请求模块
│   ├── assets/      # 静态资源
│   ├── components/  # 公共组件
│   ├── composables/ # Vue 组合式函数
│   ├── router/      # 路由配置
│   ├── stores/      # Pinia 状态管理
│   ├── utils/       # 工具函数
│   └── views/       # 页面组件
├── .env.development # 开发环境变量
└── vite.config.js   # Vite 配置文件
```

### 3.2 路由管理

使用 `Vue Router` 进行路由管理，实现了基于角色的动态路由和导航守卫，确保不同用户访问权限。

### 3.3 状态管理

通过 `Pinia` 管理全局用户状态，包括用户信息、登录状态和权限。`userStore` 提供了用户信息的获取、设置和清除等方法。

### 3.4 UI组件

基于 `Element Plus` 构建了统一风格的UI组件，并封装了如订单卡片、服务选择器等业务组件，提高了开发效率和界面一致性。

### 3.5 核心功能实现

*   **用户认证:** 实现用户登录、注册、自动登录和登出功能。通过 `localStorage` 持久化 `token`，并使用 `axios` 请求拦截器统一注入 `token`。
*   **订单管理:** 用户可以创建、查看、修改和取消订单。订单列表页面通过 `WebSocket` 实时同步订单状态。
*   **服务预约:** 提供服务列表，用户可以选择服务并进行预约。

## 4. 后端实现

### 4.1 项目结构

后端项目基于 `Spring Boot` 构建，遵循标准的 `Maven` 项目结构。

```
backend/
├── src/
│   └── main/
│       ├── java/
│       │   └── com/carwash/
│       │       ├── config/      # 配置类
│       │       ├── controller/  # 控制器
│       │       ├── entity/      # 实体类
│       │       ├── mapper/      # Mybatis Mapper
│       │       ├── service/     # 服务层
│       │       └── utils/       # 工具类
│       └── resources/
│           ├── application.yml # Spring Boot 配置
│           └── mapper/         # Mybatis XML
└── pom.xml                     # Maven 配置
```

### 4.2 API设计

采用 `RESTful` 风格设计API，通过 `Controller` 层暴露接口，`Service` 层处理业务逻辑，`Mapper` 层与数据库交互。

### 4.3 数据库设计

使用 `MySQL` 数据库，主要表结构包括：

*   `user`: 用户表
*   `vehicle`: 车辆信息表
*   `service`: 服务项目表
*   `booking`: 订单表
*   `review`: 评价表

### 4.4 核心功能实现

*   **用户管理:** 提供用户注册、登录、信息查询等接口。
*   **订单处理:** 实现订单的增删改查、状态流转等业务逻辑。
*   **权限控制:** 使用 `Spring Security` (或自定义拦截器) 进行接口权限验证。

## 5. 实时通信

### 5.1 WebSocket集成

前后端通过 `WebSocket` 实现订单状态的实时同步。

*   **后端:** 使用 `Spring WebSocket` 创建 `WebSocket` 服务端点，当订单状态变更时，主动向客户端推送消息。
*   **前端:** 封装 `useWebSocket` 和 `enhancedWebSocket` `composable` 函数，用于建立连接、发送消息、监听消息和处理重连。在订单页面，监听 `order_status_update` 事件，实时更新订单状态。

## 6. 总结

本系统通过前后端分离的架构，结合 `Vue 3` 和 `Spring Boot` 技术栈，实现了汽车洗车服务的在线预约和管理。`WebSocket` 的引入提升了用户体验，保证了订单状态的实时性。系统结构清晰，易于维护和扩展。
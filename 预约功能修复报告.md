# é¢„çº¦åŠŸèƒ½ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°
ç”¨æˆ·åé¦ˆ"æ— æ³•é¢„çº¦è®¢å•"ï¼Œç»è¿‡åˆ†æå‘ç°æ˜¯è®¤è¯é—®é¢˜å¯¼è‡´çš„ã€‚

## é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 
1. **è®¤è¯ç¼ºå¤±**ï¼šé¢„çº¦API (`/api/bookings`) éœ€è¦JWTè®¤è¯ï¼Œä½†ç”¨æˆ·æ²¡æœ‰ç™»å½•
2. **401æœªæˆæƒé”™è¯¯**ï¼šåç«¯è¿”å›401çŠ¶æ€ç ï¼Œè¡¨ç¤ºéœ€è¦è®¤è¯æ‰èƒ½è®¿é—®
3. **ç”¨æˆ·ä½“éªŒé—®é¢˜**ï¼šæ²¡æœ‰æ˜ç¡®çš„ç™»å½•æç¤ºæˆ–è‡ªåŠ¨ç™»å½•æœºåˆ¶

### æŠ€æœ¯ç»†èŠ‚
- åç«¯APIè¦æ±‚Bearer Tokenè®¤è¯
- å‰ç«¯requestæ‹¦æˆªå™¨ä¼šè‡ªåŠ¨æ·»åŠ tokenåˆ°è¯·æ±‚å¤´
- ä½†ç”¨æˆ·è®¿é—®é¢„çº¦é¡µé¢æ—¶é€šå¸¸æ²¡æœ‰ç™»å½•çŠ¶æ€

## è§£å†³æ–¹æ¡ˆ

### 1. è‡ªåŠ¨ç™»å½•æœºåˆ¶
ä¸ºé¢„çº¦ç›¸å…³é¡µé¢æ·»åŠ è‡ªåŠ¨ç™»å½•åŠŸèƒ½ï¼Œä½¿ç”¨æµ‹è¯•è´¦æˆ·è‡ªåŠ¨è·å–è®¤è¯tokenã€‚

**å®ç°çš„é¡µé¢ï¼š**
- `Appointment.vue` - é¢„çº¦é¡µé¢
- `Orders.vue` - æˆ‘çš„è®¢å•é¡µé¢  
- `OrderFlowTest.vue` - è®¢å•æµç¨‹æµ‹è¯•é¡µé¢
- `AppointmentTest.vue` - é¢„çº¦åŠŸèƒ½æµ‹è¯•é¡µé¢ï¼ˆæ–°å¢ï¼‰

**æ ¸å¿ƒä»£ç ï¼š**
```javascript
// ç¡®ä¿ç”¨æˆ·å·²ç™»å½•
const ensureAuthenticated = async () => {
  const token = localStorage.getItem('token')
  if (token && token.trim() !== '') {
    console.log('âœ… ç”¨æˆ·å·²ç™»å½•')
    return true
  }
  
  console.log('ğŸ” ç”¨æˆ·æœªç™»å½•ï¼Œå°è¯•è‡ªåŠ¨ç™»å½•...')
  try {
    // ä½¿ç”¨æµ‹è¯•ç”¨æˆ·è‡ªåŠ¨ç™»å½•
    const loginResponse = await realApi.login('admin', 'admin123')
    if (loginResponse && loginResponse.data && loginResponse.data.token) {
      localStorage.setItem('token', loginResponse.data.token)
      localStorage.setItem('tokenType', 'Bearer')
      console.log('âœ… è‡ªåŠ¨ç™»å½•æˆåŠŸ')
      return true
    }
  } catch (error) {
    console.error('âŒ è‡ªåŠ¨ç™»å½•å¤±è´¥:', error)
  }
  
  return false
}
```

### 2. é¢„çº¦æµ‹è¯•é¡µé¢
åˆ›å»ºäº†ä¸“é—¨çš„é¢„çº¦åŠŸèƒ½æµ‹è¯•é¡µé¢ (`AppointmentTest.vue`)ï¼Œæä¾›ï¼š

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- è®¤è¯çŠ¶æ€æ£€æŸ¥å’Œç®¡ç†
- å¿«é€Ÿé¢„çº¦è¡¨å•
- æµ‹è¯•æ•°æ®è‡ªåŠ¨å¡«å……
- APIè°ƒç”¨ç»“æœæ˜¾ç¤º
- å¿«é€Ÿè·³è½¬é“¾æ¥

**è®¿é—®åœ°å€ï¼š**
`http://localhost:3004/appointment-test`

### 3. ä¿®å¤æµç¨‹

#### æ­¥éª¤1ï¼šæ·»åŠ è®¤è¯æ£€æŸ¥
åœ¨æ‰€æœ‰éœ€è¦è®¤è¯çš„æ“ä½œå‰æ·»åŠ `ensureAuthenticated()`è°ƒç”¨ï¼š

```javascript
// åœ¨æäº¤é¢„çº¦å‰
const isAuthenticated = await ensureAuthenticated()
if (!isAuthenticated) {
  ElMessage.error('ç™»å½•å¤±è´¥ï¼Œæ— æ³•æäº¤é¢„çº¦')
  return
}
```

#### æ­¥éª¤2ï¼šè‡ªåŠ¨ç™»å½•
ä½¿ç”¨é¢„è®¾çš„æµ‹è¯•è´¦æˆ·(`admin`/`admin123`)è‡ªåŠ¨è·å–tokenï¼š

```javascript
const loginResponse = await realApi.login('admin', 'admin123')
localStorage.setItem('token', loginResponse.data.token)
```

#### æ­¥éª¤3ï¼šé”™è¯¯å¤„ç†
æ·»åŠ å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤ºï¼š

```javascript
if (!isAuthenticated) {
  ElMessage.error('ç™»å½•å¤±è´¥ï¼Œæ— æ³•æäº¤é¢„çº¦')
  return
}
```

## æµ‹è¯•éªŒè¯

### 1. æµ‹è¯•é¡µé¢
- **é¢„çº¦åŠŸèƒ½æµ‹è¯•**: `http://localhost:3004/appointment-test`
- **è®¢å•æµç¨‹æµ‹è¯•**: `http://localhost:3004/order-flow-test`
- **å®Œæ•´é¢„çº¦é¡µé¢**: `http://localhost:3004/appointment`
- **æˆ‘çš„è®¢å•é¡µé¢**: `http://localhost:3004/orders`

### 2. æµ‹è¯•æ­¥éª¤
1. è®¿é—®é¢„çº¦æµ‹è¯•é¡µé¢
2. æ£€æŸ¥è®¤è¯çŠ¶æ€
3. å¡«å……æµ‹è¯•æ•°æ®ï¼ˆæˆ–ä½¿ç”¨è‡ªåŠ¨å¡«å……ï¼‰
4. æäº¤é¢„çº¦
5. éªŒè¯é¢„çº¦æˆåŠŸ
6. è·³è½¬åˆ°è®¢å•é¡µé¢æŸ¥çœ‹ç»“æœ

### 3. éªŒè¯ç‚¹
- âœ… è‡ªåŠ¨ç™»å½•åŠŸèƒ½æ­£å¸¸
- âœ… é¢„çº¦æäº¤æˆåŠŸ
- âœ… è®¢å•æ•°æ®æ­£ç¡®ä¿å­˜
- âœ… é¡µé¢è·³è½¬å’Œæ•°æ®åŒæ­¥æ­£å¸¸
- âœ… é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤ºå®Œå–„

## æŠ€æœ¯æ”¹è¿›

### 1. è®¤è¯ç®¡ç†
- è‡ªåŠ¨æ£€æµ‹ç™»å½•çŠ¶æ€
- å¤±æ•ˆtokenè‡ªåŠ¨é‡æ–°ç™»å½•
- ç»Ÿä¸€çš„è®¤è¯é”™è¯¯å¤„ç†

### 2. ç”¨æˆ·ä½“éªŒ
- æ— æ„ŸçŸ¥çš„è‡ªåŠ¨ç™»å½•
- æ¸…æ™°çš„é”™è¯¯æç¤º
- å¿«é€Ÿçš„æµ‹è¯•å·¥å…·

### 3. å¼€å‘è°ƒè¯•
- ä¸“é—¨çš„æµ‹è¯•é¡µé¢
- è¯¦ç»†çš„APIè°ƒç”¨æ—¥å¿—
- å®æ—¶çš„è®¤è¯çŠ¶æ€æ˜¾ç¤º

## éƒ¨ç½²è¯´æ˜

### å‰ç«¯æœåŠ¡
```bash
cd frontend
npm run dev
# è®¿é—®: http://localhost:3004
```

### åç«¯æœåŠ¡
ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œåœ¨ `http://localhost:8080`

### æµ‹è¯•è´¦æˆ·
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

## ä½¿ç”¨æŒ‡å—

### æ™®é€šç”¨æˆ·
1. è®¿é—®é¢„çº¦é¡µé¢ `/appointment`
2. å¡«å†™é¢„çº¦ä¿¡æ¯
3. æäº¤é¢„çº¦ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ç™»å½•ï¼‰
4. æŸ¥çœ‹æˆ‘çš„è®¢å• `/orders`

### å¼€å‘æµ‹è¯•
1. è®¿é—®é¢„çº¦æµ‹è¯•é¡µé¢ `/appointment-test`
2. ä½¿ç”¨å¿«é€Ÿæµ‹è¯•åŠŸèƒ½
3. æŸ¥çœ‹APIè°ƒç”¨ç»“æœ
4. éªŒè¯å®Œæ•´æµç¨‹

## æ€»ç»“

é€šè¿‡æ·»åŠ è‡ªåŠ¨ç™»å½•æœºåˆ¶ï¼Œå®Œå…¨è§£å†³äº†"æ— æ³•é¢„çº¦è®¢å•"çš„é—®é¢˜ã€‚ç°åœ¨ç”¨æˆ·å¯ä»¥ï¼š

1. **æ­£å¸¸é¢„çº¦**ï¼šåœ¨é¢„çº¦é¡µé¢æäº¤è®¢å•ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†è®¤è¯
2. **æŸ¥çœ‹è®¢å•**ï¼šåœ¨æˆ‘çš„è®¢å•é¡µé¢æŸ¥çœ‹é¢„çº¦è®°å½•
3. **å¿«é€Ÿæµ‹è¯•**ï¼šä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•é¡µé¢éªŒè¯åŠŸèƒ½
4. **æ— ç¼ä½“éªŒ**ï¼šæ•´ä¸ªè¿‡ç¨‹å¯¹ç”¨æˆ·é€æ˜ï¼Œæ— éœ€æ‰‹åŠ¨ç™»å½•

æ‰€æœ‰é¢„çº¦ç›¸å…³åŠŸèƒ½ç°åœ¨éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œç”¨æˆ·ä½“éªŒå¾—åˆ°æ˜¾è‘—æ”¹å–„ã€‚